---
// Import du layout standard
import Layout from '../../layouts/layout.astro';

// Récupérer le paramètre de langue depuis l'URL
export function getStaticPaths() {
  return [
    { params: { lang: 'fr' } },
    { params: { lang: 'en' } },
    { params: { lang: 'de' } }
  ];
}

const lang = Astro.params.lang as 'fr' | 'en' | 'de';

// Contenu traduit pour chaque langue
const content = {
  fr: {
    title: 'Josselin HANEL - Demande de devis',
    description: 'Formulaire de demande de devis pour votre projet web éco-responsable',
    quoteTitle: 'Demande de devis',
    quoteIntro: "Précisez vos besoins pour recevoir un devis personnalisé. Je vous répondrai dans les plus brefs délais.",
    
    // Labels formulaire
    nameLabel: 'Votre nom',
    emailLabel: 'Votre email',
    phoneLabel: 'Votre téléphone (optionnel)',
    projectTypeLabel: 'Type de projet',
    projectTypeOptions: {
      website: 'Site vitrine',
      application: 'Application web',
      ecommerce: 'Site e-commerce',
      other: 'Autre (préciser)'
    },
    budgetLabel: 'Budget approximatif',
    budgetOptions: {
      low: 'Moins de 500€',
      medium: '500€ à 1000€',
      high: 'Plus de 1000€',
      flexible: 'Flexible / À discuter'
    },
    deadlineLabel: 'Échéance souhaitée',
    deadlineOptions: {
      urgent: 'Urgent (moins d\'un mois)',
      medium: 'Dans 1 à 3 mois',
      flexible: 'Flexible / Pas d\'urgence'
    },
    projectDescLabel: 'Description du projet',
    projectDescPlaceholder: 'Décrivez votre projet, ses objectifs, et toute information utile pour établir un devis pertinent...',
    additionalInfoLabel: 'Informations complémentaires',
    additionalInfoPlaceholder: 'Autres détails, fonctionnalités spécifiques, contraintes particulières...',
    
    submitButton: 'Demander un devis',
    submitting: 'Envoi en cours...',
    successMessage: 'Merci ! Votre demande de devis a été envoyée avec succès. Je vous contacterai sous peu.',
    errorMessage: 'Une erreur est survenue. Veuillez réessayer ou me contacter directement par email.',
    requiredField: 'Ce champ est requis'
  },
  en: {
    title: 'Josselin HANEL - Quote Request',
    description: 'Request form for your eco-friendly web project quote',
    quoteTitle: 'Quote Request',
    quoteIntro: "Specify your needs to receive a personalized quote. I will get back to you as soon as possible.",
    
    // Form labels
    nameLabel: 'Your name',
    emailLabel: 'Your email',
    phoneLabel: 'Your phone (optional)',
    projectTypeLabel: 'Project type',
    projectTypeOptions: {
      website: 'Showcase website',
      application: 'Web application',
      ecommerce: 'E-commerce site',
      other: 'Other (specify)'
    },
    budgetLabel: 'Approximate budget',
    budgetOptions: {
      low: 'Less than €500',
      medium: '€500 to €1000',
      high: 'More than €1000',
      flexible: 'Flexible / To be discussed'
    },
    deadlineLabel: 'Desired deadline',
    deadlineOptions: {
      urgent: 'Urgent (less than a month)',
      medium: 'In 1 to 3 months',
      flexible: 'Flexible / No urgency'
    },
    projectDescLabel: 'Project description',
    projectDescPlaceholder: 'Describe your project, its objectives, and any useful information to establish a relevant quote...',
    additionalInfoLabel: 'Additional information',
    additionalInfoPlaceholder: 'Other details, specific features, particular constraints...',
    
    submitButton: 'Request a quote',
    submitting: 'Sending...',
    successMessage: 'Thank you! Your quote request has been successfully sent. I will contact you soon.',
    errorMessage: 'An error occurred. Please try again or contact me directly by email.',
    requiredField: 'This field is required'
  },
  de: {
    title: 'Josselin HANEL - Angebotsanfrage',
    description: 'Anfrageformular für Ihr umweltfreundliches Webprojekt',
    quoteTitle: 'Angebotsanfrage',
    quoteIntro: "Geben Sie Ihre Anforderungen an, um ein personalisiertes Angebot zu erhalten. Ich werde mich so schnell wie möglich bei Ihnen melden.",
    
    // Formular-Labels
    nameLabel: 'Ihr Name',
    emailLabel: 'Ihre E-Mail',
    phoneLabel: 'Ihre Telefonnummer (optional)',
    projectTypeLabel: 'Projekttyp',
    projectTypeOptions: {
      website: 'Präsentationswebsite',
      application: 'Webanwendung',
      ecommerce: 'E-Commerce-Site',
      other: 'Andere (bitte angeben)'
    },
    budgetLabel: 'Ungefähres Budget',
    budgetOptions: {
      low: 'Weniger als 500€',
      medium: '500€ bis 1000€',
      high: 'Mehr als 1000€',
      flexible: 'Flexibel / Zu besprechen'
    },
    deadlineLabel: 'Gewünschter Termin',
    deadlineOptions: {
      urgent: 'Dringend (weniger als ein Monat)',
      medium: 'In 1 bis 3 Monaten',
      flexible: 'Flexibel / Keine Eile'
    },
    projectDescLabel: 'Projektbeschreibung',
    projectDescPlaceholder: 'Beschreiben Sie Ihr Projekt, seine Ziele und alle nützlichen Informationen für ein relevantes Angebot...',
    additionalInfoLabel: 'Zusätzliche Informationen',
    additionalInfoPlaceholder: 'Weitere Details, spezifische Funktionen, besondere Einschränkungen...',
    
    submitButton: 'Angebot anfordern',
    submitting: 'Wird gesendet...',
    successMessage: 'Vielen Dank! Ihre Angebotsanfrage wurde erfolgreich gesendet. Ich werde mich in Kürze bei Ihnen melden.',
    errorMessage: 'Ein Fehler ist aufgetreten. Bitte versuchen Sie es erneut oder kontaktieren Sie mich direkt per E-Mail.',
    requiredField: 'Dieses Feld ist erforderlich'
  }
};

// Utiliser la langue demandée ou français par défaut
const t = content[lang] || content.fr;

// Services plus détaillés basés sur l'annonce ComeUp
const serviceDetails = {
  fr: {
    basic: {
      title: "Site Basique",
      price: "230 €",
      features: [
        "Une page vitrine simple",
        "Présentation de votre activité",
        "Coordonnées & réseaux et/ou formulaire de contact",
        "Affichage mobile/tablette + référencement naturel optimisé",
        "Animations pour faire ressortir les éléments critiques"
      ]
    },
    standard: {
      title: "Site Standard",
      price: "450 €",
      features: [
        "Jusqu'à 3 pages (ex. : Accueil, À propos, Contact)",
        "Formulaire de contact avec possibilité d'envoi de fichiers",
        "Animations légères et effets d'interface modernes",
        "Transitions douces, retours visuels sur les actions"
      ]
    },
    premium: {
      title: "Site Premium",
      price: "650 €",
      features: [
        "Jusqu'à 6 pages ou sections",
        "Design sur-mesure sans limite",
        "Animations avancées: apparition au scroll, parallaxe légère",
        "Transitions dynamiques, interactions subtiles"
      ]
    }
  },
  en: {
    basic: {
      title: "Basic Website",
      price: "€230",
      features: [
        "A simple showcase page",
        "Presentation of your activity",
        "Contact information & social networks and/or contact form",
        "Mobile/tablet display + optimized natural referencing",
        "Animations to highlight critical elements"
      ]
    },
    standard: {
      title: "Standard Website",
      price: "€450",
      features: [
        "Up to 3 pages (e.g.: Home, About, Contact)",
        "Contact form with the possibility of sending files",
        "Light animations and modern interface effects",
        "Smooth transitions, visual feedback on actions"
      ]
    },
    premium: {
      title: "Premium Website",
      price: "€650",
      features: [
        "Up to 6 pages or sections",
        "Unlimited custom design",
        "Advanced animations: scroll appearance, light parallax",
        "Dynamic transitions, subtle interactions"
      ]
    }
  },
  de: {
    basic: {
      title: "Basis-Website",
      price: "230 €",
      features: [
        "Eine einfache Showcase-Seite",
        "Präsentation Ihrer Aktivität",
        "Kontaktdaten & soziale Netzwerke und/oder Kontaktformular",
        "Mobile/Tablet-Anzeige + optimierte natürliche Referenzierung",
        "Animationen, um kritische Elemente hervorzuheben"
      ]
    },
    standard: {
      title: "Standard-Website",
      price: "450 €",
      features: [
        "Bis zu 3 Seiten (z.B.: Startseite, Über uns, Kontakt)",
        "Kontaktformular mit der Möglichkeit, Dateien zu senden",
        "Leichte Animationen und moderne Oberflächeneffekte",
        "Sanfte Übergänge, visuelle Rückmeldung bei Aktionen"
      ]
    },
    premium: {
      title: "Premium-Website",
      price: "650 €",
      features: [
        "Bis zu 6 Seiten oder Abschnitte",
        "Unbegrenztes individuelles Design",
        "Erweiterte Animationen: Scroll-Erscheinung, leichte Parallaxe",
        "Dynamische Übergänge, subtile Interaktionen"
      ]
    }
  }
};

// Options complémentaires
const additionalOptions = {
  fr: [
    {
      title: "Site multilingue",
      price: "150 €",
      description: "Jusqu'à 2 langues supplémentaires avec sélecteur manuel ou détection automatique"
    },
    {
      title: "Gestion via interface graphique (Decap CMS)",
      price: "200 €",
      description: "Interface admin intégrée pour modifier vos textes, images et ajouter du contenu sans coder"
    },
    {
      title: "Gestion via tableaux de type Excel",
      price: "100 €",
      description: "Édition simple via un tableau Google pour modifier descriptions, tarifs, horaires"
    },
    {
      title: "Statistiques détaillées sans cookies",
      price: "70 €",
      description: "Suivi de trafic RGPD-friendly avec tableau de bord clair et accessible"
    }
  ],
  en: [
    {
      title: "Multilingual site",
      price: "€150",
      description: "Up to 2 additional languages with manual selector or automatic detection"
    },
    {
      title: "Management via graphical interface (Decap CMS)",
      price: "€200",
      description: "Integrated admin interface to modify your texts, images, and add content without coding"
    },
    {
      title: "Management via Excel-type tables",
      price: "€100",
      description: "Simple editing via a Google sheet to modify descriptions, prices, schedules"
    },
    {
      title: "Detailed statistics without cookies",
      price: "€70",
      description: "GDPR-friendly traffic tracking with a clear and accessible dashboard"
    }
  ],
  de: [
    {
      title: "Mehrsprachige Website",
      price: "150 €",
      description: "Bis zu 2 zusätzliche Sprachen mit manuellem Selektor oder automatischer Erkennung"
    },
    {
      title: "Verwaltung über grafische Oberfläche (Decap CMS)",
      price: "200 €",
      description: "Integrierte Admin-Oberfläche zum Ändern von Texten, Bildern und Hinzufügen von Inhalten ohne Programmierung"
    },
    {
      title: "Verwaltung über Excel-ähnliche Tabellen",
      price: "100 €",
      description: "Einfache Bearbeitung über eine Google-Tabelle zur Änderung von Beschreibungen, Preisen, Zeitplänen"
    },
    {
      title: "Detaillierte Statistiken ohne Cookies",
      price: "70 €",
      description: "DSGVO-freundliches Traffic-Tracking mit einem übersichtlichen und zugänglichen Dashboard"
    }
  ]
};

// Déterminer si le mode éco est actif en fonction de l'URL
const { pathname } = Astro.url;
const isEcoMode = pathname.includes('/eco');
---

<Layout title={t.title} description={t.description} lang={lang} isEcoMode={isEcoMode}>
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6 border-b border-accent pb-2">
      {t.quoteTitle}
    </h1>
    
    <div class="flex flex-col md:flex-row gap-8">
      <!-- Formulaire de devis -->
      <div class="md:w-2/3">
        <p class="mb-6">
          {t.quoteIntro}
        </p>
        
        <form id="quote-form" class="space-y-5">
          <!-- Champ caché pour API Web3Forms -->
          <input type="hidden" name="access_key" value="2dcc3f1b-036f-48a7-987a-cdada0d05ae5">
          <input type="hidden" name="from_name" value="Portfolio Devis">
          <input type="hidden" name="subject" value="Nouvelle demande de devis">
          
          <!-- Section Info de contact -->
          <div class="bg-secondary bg-opacity-20 p-5 rounded-lg space-y-4">
            <h2 class="text-xl font-semibold text-accent mb-3">
              {lang === 'fr' ? 'Vos coordonnées' : lang === 'en' ? 'Your contact information' : 'Ihre Kontaktdaten'}
            </h2>
            
            <!-- Nom -->
            <div>
              <label for="name" class="block mb-1 font-medium">{t.nameLabel} *</label>
              <input 
                type="text" 
                id="name" 
                name="name"
                class="w-full p-2 border border-form bg-primary rounded-md"
                required
              />
            </div>
            
            <!-- Email -->
            <div>
              <label for="email" class="block mb-1 font-medium">{t.emailLabel} *</label>
              <input 
                type="email" 
                id="email" 
                name="email"
                class="w-full p-2 border border-form bg-primary rounded-md"
                required
              />
            </div>
            
            <!-- Téléphone -->
            <div>
              <label for="phone" class="block mb-1 font-medium">{t.phoneLabel}</label>
              <input 
                type="tel" 
                id="phone" 
                name="phone"
                class="w-full p-2 border border-form bg-primary rounded-md"
              />
            </div>
          </div>
          
          <!-- Section détails du projet -->
          <div class="bg-secondary bg-opacity-20 p-5 rounded-lg space-y-4">
            <h2 class="text-xl font-semibold text-accent mb-3">
              {lang === 'fr' ? 'Détails du projet' : lang === 'en' ? 'Project details' : 'Projektdetails'}
            </h2>
            
            <!-- Type de projet -->
            <div>
              <label for="project_type" class="block mb-1 font-medium">{t.projectTypeLabel} *</label>
              <select 
                id="project_type" 
                name="project_type"
                class="w-full p-2 border border-form bg-primary rounded-md"
                required
              >
                <option value="" selected disabled>
                  {lang === 'fr' ? 'Sélectionnez une option' : lang === 'en' ? 'Select an option' : 'Wählen Sie eine Option'}
                </option>
                <option value="website">{t.projectTypeOptions.website}</option>
                <option value="application">{t.projectTypeOptions.application}</option>
                <option value="ecommerce">{t.projectTypeOptions.ecommerce}</option>
                <option value="other">{t.projectTypeOptions.other}</option>
              </select>
            </div>
            
            <!-- Formule souhaitée -->
            <div>
              <label for="service_package" class="block mb-1 font-medium">
                {lang === 'fr' ? 'Formule envisagée' : lang === 'en' ? 'Desired package' : 'Gewünschtes Paket'}
              </label>
              <select 
                id="service_package" 
                name="service_package"
                class="w-full p-2 border border-form bg-primary rounded-md"
              >
                <option value="" selected>
                  {lang === 'fr' ? 'Je ne sais pas encore' : lang === 'en' ? 'I don\'t know yet' : 'Ich weiß es noch nicht'}
                </option>
                <option value="basic">
                  {serviceDetails[lang].basic.title} - {serviceDetails[lang].basic.price}
                </option>
                <option value="standard">
                  {serviceDetails[lang].standard.title} - {serviceDetails[lang].standard.price}
                </option>
                <option value="premium">
                  {serviceDetails[lang].premium.title} - {serviceDetails[lang].premium.price}
                </option>
              </select>
            </div>
            
            <!-- Budget -->
            <div>
              <label for="budget" class="block mb-1 font-medium">{t.budgetLabel}</label>
              <select 
                id="budget" 
                name="budget"
                class="w-full p-2 border border-form bg-primary rounded-md"
              >
                <option value="flexible" selected>{t.budgetOptions.flexible}</option>
                <option value="low">{t.budgetOptions.low}</option>
                <option value="medium">{t.budgetOptions.medium}</option>
                <option value="high">{t.budgetOptions.high}</option>
              </select>
            </div>
            
            <!-- Délai -->
            <div>
              <label for="deadline" class="block mb-1 font-medium">{t.deadlineLabel}</label>
              <select 
                id="deadline" 
                name="deadline"
                class="w-full p-2 border border-form bg-primary rounded-md"
              >
                <option value="flexible" selected>{t.deadlineOptions.flexible}</option>
                <option value="urgent">{t.deadlineOptions.urgent}</option>
                <option value="medium">{t.deadlineOptions.medium}</option>
              </select>
            </div>
            
            <!-- Description du projet -->
            <div>
              <label for="project_description" class="block mb-1 font-medium">{t.projectDescLabel} *</label>
              <textarea 
                id="project_description"
                name="project_description" 
                class="w-full p-2 border border-form bg-primary rounded-md h-32"
                placeholder={t.projectDescPlaceholder}
                required
              ></textarea>
            </div>
          </div>
          
          <!-- Section Options -->
          <div class="bg-secondary bg-opacity-20 p-5 rounded-lg space-y-4">
            <h2 class="text-xl font-semibold text-accent mb-3">
              {lang === 'fr' ? 'Options intéressantes' : lang === 'en' ? 'Interesting options' : 'Interessante Optionen'}
            </h2>
            
            <div class="space-y-3">
              {additionalOptions[lang].map((option, index) => (
                <div class="flex items-start">
                  <input 
                    type="checkbox" 
                    id={`option_${index}`} 
                    name="options" 
                    value={option.title}
                    class="mt-1 mr-2" 
                  />
                  <label for={`option_${index}`} class="cursor-pointer">
                    <div class="font-medium">{option.title} - {option.price}</div>
                    <div class="text-sm text-text-muted">{option.description}</div>
                  </label>
                </div>
              ))}
            </div>
            
            <!-- Informations complémentaires -->
            <div class="mt-4">
              <label for="additional_info" class="block mb-1 font-medium">{t.additionalInfoLabel}</label>
              <textarea 
                id="additional_info"
                name="additional_info" 
                class="w-full p-2 border border-form bg-primary rounded-md h-24"
                placeholder={t.additionalInfoPlaceholder}
              ></textarea>
            </div>
          </div>
          
          <!-- Champ honeypot pour éviter le spam -->
          <div class="hidden">
            <input type="text" name="botcheck" />
          </div>
          
          <!-- Bouton d'envoi -->
          <div class="flex justify-end gap-4">
            <span id="form-spinner" style="display: none;" class="inline-flex items-center">
                <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-accent" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                {t.submitting}
              </span>
            <button 
              type="submit"
              class="cta-button"
              id="submit-button"
            >
              {t.submitButton}
            </button>
          </div>
          
          <!-- Conteneur pour les messages de feedback -->
          <div id="form-messages" class="mt-4"></div>
        </form>
      </div>
      
      <!-- Sidebar avec informations sur les offres -->
      <div class="md:w-1/3">
        <div class="bg-secondary bg-opacity-30 p-5 rounded-lg mb-6">
          <h2 class="text-xl font-semibold mb-4 text-accent">
            {lang === 'fr' ? 'Mes offres' : lang === 'en' ? 'My offers' : 'Meine Angebote'}
          </h2>
          
          <div class="space-y-4">
            {/* Basic */}
            <div class="p-3 border border-accent border-opacity-30 rounded-lg">
              <div class="font-semibold text-accent mb-1">
                {serviceDetails[lang].basic.title} - {serviceDetails[lang].basic.price}
              </div>
              <ul class="list-disc pl-5 text-sm">
                {serviceDetails[lang].basic.features.map(feature => (
                  <li>{feature}</li>
                ))}
              </ul>
            </div>
            
            {/* Standard */}
            <div class="p-3 border border-accent border-opacity-30 rounded-lg">
              <div class="font-semibold text-accent mb-1">
                {serviceDetails[lang].standard.title} - {serviceDetails[lang].standard.price}
              </div>
              <ul class="list-disc pl-5 text-sm">
                {serviceDetails[lang].standard.features.map(feature => (
                  <li>{feature}</li>
                ))}
              </ul>
            </div>
            
            {/* Premium */}
            <div class="p-3 border border-accent border-opacity-30 rounded-lg">
              <div class="font-semibold text-accent mb-1">
                {serviceDetails[lang].premium.title} - {serviceDetails[lang].premium.price}
              </div>
              <ul class="list-disc pl-5 text-sm">
                {serviceDetails[lang].premium.features.map(feature => (
                  <li>{feature}</li>
                ))}
              </ul>
            </div>
          </div>
          
          <p class="mt-4 text-sm text-text-muted">
            {lang === 'fr' 
              ? 'Un devis détaillé et personnalisé vous sera envoyé après étude de votre demande.'
              : lang === 'en'
                ? 'A detailed and personalized quote will be sent to you after studying your request.'
                : 'Ein detailliertes und personalisiertes Angebot wird Ihnen nach Prüfung Ihrer Anfrage zugesandt.'}
          </p>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script define:vars={{ successMessage: t.successMessage, errorMessage: t.errorMessage, submittingMessage: t.submitting }}>
  document.addEventListener('astro:page-load', function() {
    // Gestion du formulaire de devis
    const form = document.getElementById('quote-form');
    const formMessages = document.getElementById('form-messages');
    const submitButton = document.getElementById('submit-button');
    const formSpinner = document.getElementById('form-spinner');
    
    if (form && formMessages && submitButton && formSpinner) {
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Afficher l'indicateur de chargement
        submitButton.disabled = true;
        formSpinner.style.display = 'inline-flex';
        formMessages.innerHTML = '';
        
        // Obtenir les données du formulaire
        const formData = new FormData(form);
        
        // Traitement spécial pour les checkboxes d'options
        const selectedOptions = [];
        document.querySelectorAll('input[name="options"]:checked').forEach(checkbox => {
          selectedOptions.push(checkbox.value);
        });
        
        // Supprimer le champ existant et ajouter un seul champ avec toutes les options
        for (const pair of formData.entries()) {
          if (pair[0] === 'options') {
            formData.delete(pair[0]);
          }
        }
        
        if (selectedOptions.length > 0) {
          formData.append('selected_options', selectedOptions.join(', '));
        } else {
          formData.append('selected_options', 'Aucune option sélectionnée');
        }
        
        // Envoyer la requête
        fetch('https://api.web3forms.com/submit', {
          method: 'POST',
          body: formData
        })
        .then(response => response.json())
        .then(data => {
          // Masquer l'indicateur de chargement
          submitButton.disabled = false;
          formSpinner.style.display = 'none';
          
          // Vider d'abord le conteneur pour éviter les animations multiples
          formMessages.innerHTML = '';
          
          // Message basé sur le succès ou l'échec
          let messageText = data.success ? successMessage : errorMessage;
          
          // Créer l'élément de message
          const messageElement = document.createElement('div');
          messageElement.className = data.success ? 
            'p-3 bg-green-100/20 text-green-500 border border-green-500/30 rounded-md' : 
            'p-3 bg-red-100/20 text-red-500 border border-red-500/30 rounded-md';
          messageElement.textContent = messageText;
          messageElement.style.opacity = '0';
          messageElement.style.transform = 'translateY(-10px)';
          
          // Ajouter l'élément au DOM
          formMessages.appendChild(messageElement);
          
          // Animation manuelle avec JavaScript
          setTimeout(() => {
            messageElement.style.transition = 'opacity 0.4s ease-out, transform 0.4s ease-out';
            messageElement.style.opacity = '1';
            messageElement.style.transform = 'translateY(0)';
          }, 10);
          
          if (data.success) {
            // Réinitialiser le formulaire
            form.reset();
          }
        })
        .catch(error => {
          // Masquer l'indicateur de chargement
          submitButton.disabled = false;
          formSpinner.style.display = 'none';
          
          // Vider d'abord le conteneur
          formMessages.innerHTML = '';
          
          // Créer l'élément de message d'erreur
          const messageElement = document.createElement('div');
          messageElement.className = 'p-3 bg-red-100/20 text-red-500 border border-red-500/30 rounded-md';
          messageElement.textContent = errorMessage;
          messageElement.style.opacity = '0';
          messageElement.style.transform = 'translateY(-10px)';
          
          // Ajouter le message au DOM
          formMessages.appendChild(messageElement);
          
          // Animation manuelle avec JavaScript
          setTimeout(() => {
            messageElement.style.transition = 'opacity 0.4s ease-out, transform 0.4s ease-out';
            messageElement.style.opacity = '1';
            messageElement.style.transform = 'translateY(0)';
          }, 10);
          
          console.error('Error:', error);
        });
      });
    }
    
    // Afficher/cacher le champ "Autre" lorsque "Autre" est sélectionné dans le type de projet
    const projectTypeSelect = document.getElementById('project_type');
    if (projectTypeSelect) {
      projectTypeSelect.addEventListener('change', function() {
        // Implémenter si nécessaire pour afficher un champ supplémentaire
      });
    }
  });
</script>