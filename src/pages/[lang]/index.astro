---
// Imports
import Layout from "../../layouts/layout.astro";
import { Picture } from "astro:assets";
import monImage from "../../assets/j.jpg";
import CtaDispo from "../../components/cta_dispo.astro";
import { getCollection } from 'astro:content';
import { loadHeroImage } from '../../utils/imageLoader';

// R√©cup√©rer le param√®tre de langue depuis l'URL
export function getStaticPaths() {
  return [
    { params: { lang: "fr" } },
    { params: { lang: "en" } },
    { params: { lang: "de" } },
  ];
}

// R√©cup√©ration des 2 projets les plus r√©cents
const allProjects = await getCollection("projects");
const recentProjects = allProjects
  .sort((a, b) => b.data.order - a.data.order)
  .slice(0, 2);

const lang = Astro.params.lang as "fr" | "en" | "de";

// Titre et description de la page pour SEO (√† traduire selon la langue)
const content = {
  fr: {
    title: "Josselin HANEL - Cr√©ateur de sites internet",
    description: "Cr√©ateur de sites internet qui marchent bien, rapides et moins gourmands en √©nergie. Bas√© √† Rennes, disponible √† Quimper, Paris, Berlin et √† distance.",
    heroText: "Je cr√©e des sites qui chargent vite, s'affichent correctement sur tous les appareils, et sont bien plac√©s sur Google. Le tout via des technologies modernes, √©conomiques et √©cologiques.",
    values: [
      { 
        title: "Rapidit√©", 
        description: "Des sites qui ne font pas attendre vos visiteurs.",
        emoji: "‚ö°" 
      },
      { 
        title: "Simplicit√©", 
        description: "Des solutions qui vont droit au but, faciles √† mettre √† jour.",
        emoji: "‚ú®" 
      },
      { 
        title: "√âconomie d'√©nergie", 
        description: "Des sites plus l√©gers qui font baisser vos factures d'h√©bergement.",
        emoji: "üå±"
      },
      { 
        title: "Autonomie", 
        description: "Des sites que vous pouvez faire √©voluer facilement.",
        emoji: "üöÄ" 
      }
    ],
    projectsButton: "Voir mes r√©alisations",
    contactButton: "Me contacter",
    servicesTitle: "Services",
    services: [
      {
        title: "Sites pour pr√©senter votre activit√©",
        description: "Sites professionnels personnalis√©s, rapides et bien plac√©s sur Google - sans WordPress ni abonnements co√ªteux.",
        emoji: "üåê"
      },
      {
        title: "Applications web",
        description: "Outils en ligne sur mesure pour automatiser vos t√¢ches et am√©liorer l'exp√©rience de vos utilisateurs.",
        emoji: "‚öôÔ∏è"
      },
      {
        title: "Boutiques en ligne",
        description: "Solutions de vente en ligne modernes et rapides, sans les frais mensuels des plateformes habituelles.",
        emoji: "üõí"
      },
      {
        title: "Conseils",
        description: "Conseils pour rendre vos sites existants plus rapides, moins √©nergivores et plus agr√©ables √† utiliser.",
        emoji: "üí°"
      }
    ],
    projectsTitle: "Projets r√©cents",
    projectButton: "Voir ce projet",
    viewAllProjectsButton: "Voir tous les projets",
    // Motivations
    motivationTitle: "Ce qui me motive",
    motivationIntro: "Je crois √† un web qui allie rapidit√©, simplicit√© et respect de l'environnement. Aujourd'hui, trop de sites sont lourds, lents √† charger et consomment beaucoup d'√©nergie alors qu'on peut facilement faire autrement ! Ma d√©marche s'appuie sur ces principes :",
    motivationPrinciples: [
      {
        title: "La bonne technique au bon endroit",
        description: "Les navigateurs modernes peuvent faire beaucoup de choses sans avoir besoin d'installer des tonnes de modules suppl√©mentaires. J'utilise les technologies existantes et leurs √©volutions de mani√®re intelligente pour cr√©er des exp√©riences fluides."
      },
      {
        title: "Le respect du visiteur",
        description: "Pas de fen√™tres pop-up aga√ßantes ni de bandeaux qui g√™nent la navigation. Une exp√©rience agr√©able o√π l'utilisateur reste ma√Ætre de sa navigation et de ses donn√©es."
      },
      {
        title: "L√©ger d'abord, puissant si besoin",
        description: "Site vitrine ? Pages pr√©-g√©n√©r√©es ultra-rapides. E-commerce simple ? Pareil, avec juste quelques fonctions √† la demande. Application interactive avec chat ? L√† j'utilise Elixir/Phoenix, con√ßu pour g√©rer des milliers d'utilisateurs simultan√©s efficacement."
      }
    ],
    didYouKnowTitle: "Le saviez-vous ?",
    didYouKnowItems: [
      {
        text: "Contrairement √† ce qu'on croit souvent, la loi n'oblige pas √† afficher un bandeau de cookies sur tous les sites. Ces bandeaux ne sont obligatoires que si votre site utilise des traceurs autres que ceux strictement n√©cessaires au fonctionnement.",
        source: "GDPR.eu - Cookies, the GDPR, and the ePrivacy Directive",
        link: "https://gdpr.eu/cookies/"
      },
      {
        text: "53% des visiteurs quittent un site qui met plus de 3 secondes √† charger. Avoir un site rapide est essentiel pour ne pas perdre de visiteurs.",
        source: "Think with Google - Mobile page speed benchmarks",
        link: "https://support.google.com/adsense/answer/7450973/"
      },
      {
        text: "Il est tout √† fait possible d'analyser les visites de votre site sans utiliser de cookies de suivi ni compromettre la vie priv√©e de vos visiteurs.",
        details: "Des solutions comme Plausible, Umami Cloud ou Matomo (en mode sans cookies) vous donnent des statistiques pr√©cises en respectant la vie priv√©e, sans n√©cessiter de consentement explicite."
      }
    ],
    quoteText: "Combien de fois avez-vous quitt√© un site parce qu'il √©tait trop lent ou vous harcelait pour accepter des cookies? Je pr√©f√®re un web plus l√©ger, qui respecte l'attention du visiteur et fonctionne bien sur tous les appareils sans frustration."
  },
  en: {
    title: "Josselin HANEL - Full Stack Web Developer",
    description: "Full stack web developer creating fast, efficient and eco-friendly websites. Based in Rennes (France), available in Quimper, Paris, Berlin and for remote work.",
    heroText: "I create websites that load quickly, display correctly on all devices, and rank well on Google. All using modern, cost-effective and eco-friendly technologies.",
    values: [
      { 
        title: "Speed", 
        description: "Websites that don't keep your visitors waiting.",
        emoji: "‚ö°" 
      },
      { 
        title: "Simplicity", 
        description: "Solutions that get straight to the point, easy to update.",
        emoji: "‚ú®" 
      },
      { 
        title: "Energy saving", 
        description: "Lighter websites that lower your hosting bills.",
        emoji: "üå±"
      },
      { 
        title: "Autonomy", 
        description: "Websites you can easily evolve.",
        emoji: "üöÄ" 
      }
    ],
    projectsButton: "View my projects",
    contactButton: "Contact me",
    servicesTitle: "Services",
    services: [
      {
        title: "Showcase websites",
        description: "Personalized, fast and well-ranked professional websites - without WordPress or costly subscriptions.",
        emoji: "üåê"
      },
      {
        title: "Web applications",
        description: "Custom online tools to automate your tasks and improve your users' experience.",
        emoji: "‚öôÔ∏è"
      },
      {
        title: "Online stores",
        description: "Modern and fast e-commerce solutions, without the monthly fees of traditional platforms.",
        emoji: "üõí"
      },
      {
        title: "Consulting",
        description: "Advice to make your existing sites faster, less energy-intensive and more user-friendly.",
        emoji: "üí°"
      }
    ],
    projectsTitle: "Recent projects",
    projectButton: "Explore project",
    viewAllProjectsButton: "View all projects",
    // Motivations
    motivationTitle: "What drives me",
    motivationIntro: "I believe in a web that combines speed, simplicity and environmental respect. Today, too many sites are heavy, slow to load and consume a lot of energy when we can easily do otherwise! My approach is based on these principles:",
    motivationPrinciples: [
      {
        title: "The right technology in the right place",
        description: "Modern browsers can do many things without needing to install tons of additional modules. I use existing technologies and their evolutions intelligently to create smooth experiences."
      },
      {
        title: "Respect for visitors",
        description: "No annoying pop-ups or banners that interfere with navigation. A pleasant experience where users remain in control of their navigation and data."
      },
      {
        title: "Light first, powerful when needed",
        description: "Showcase website? Ultra-fast pre-generated pages. Simple e-commerce? Same, with just a few on-demand functions. Interactive app with chat? There I use Elixir/Phoenix, designed to efficiently handle thousands of simultaneous users."
      }
    ],
    didYouKnowTitle: "Did you know?",
    didYouKnowItems: [
      {
        text: "Contrary to popular belief, the law doesn't require displaying a cookie banner on all websites. These banners are only mandatory if your site uses trackers other than those strictly necessary for operation.",
        source: "GDPR.eu - Cookies, the GDPR, and the ePrivacy Directive",
        link: "https://gdpr.eu/cookies/"
      },
      {
        text: "53% of visitors leave a site that takes more than 3 seconds to load. Having a fast site is essential to not lose visitors.",
        source: "Think with Google - Mobile page speed benchmarks",
        link: "https://support.google.com/adsense/answer/7450973/"
      },
      {
        text: "It's entirely possible to analyze your site's visits without using tracking cookies or compromising your visitors' privacy.",
        details: "Solutions like Plausible, Umami Cloud or Matomo (in cookie-free mode) give you accurate statistics while respecting privacy, without requiring explicit consent."
      }
    ],
    quoteText: "How many times have you left a website because it was too slow or harassing you to accept cookies? I prefer a lighter web that respects visitor attention and works well on all devices without frustration."
  },
  de: {
    title: "Josselin HANEL - Full-Stack Webentwickler",
    description: "Full-Stack Webentwickler, der schnelle, effiziente und umweltfreundliche Websites erstellt. Mit Sitz in Rennes (Frankreich), verf√ºgbar in Quimper, Paris, Berlin und f√ºr Remote-Arbeit.",
    heroText: "Ich erstelle Websites, die schnell laden, auf allen Ger√§ten korrekt angezeigt werden und gut bei Google platziert sind. Alles mit modernen, kosteng√ºnstigen und umweltfreundlichen Technologien.",
    values: [
      { 
        title: "Schnelligkeit", 
        description: "Websites, die Ihre Besucher nicht warten lassen.",
        emoji: "‚ö°"
      },
      { 
        title: "Einfachheit", 
        description: "L√∂sungen, die auf den Punkt kommen, leicht zu aktualisieren.",
        emoji: "‚ú®"
      },
      { 
        title: "Energieeinsparung", 
        description: "Leichtere Websites, die Ihre Hosting-Kosten senken.",
        emoji: "üå±"
      },
      { 
        title: "Autonomie", 
        description: "Websites, die Sie leicht weiterentwickeln k√∂nnen.",
        emoji: "üöÄ"
      }
    ],
    projectsButton: "Meine Projekte",
    contactButton: "Kontakt",
    servicesTitle: "Dienstleistungen",
    services: [
      {
        title: "Pr√§sentations-Websites",
        description: "Personalisierte, schnelle und gut platzierte professionelle Websites - ohne WordPress oder kostspielige Abonnements.",
        emoji: "üåê"
      },
      {
        title: "Webanwendungen",
        description: "Ma√ügeschneiderte Online-Tools zur Automatisierung Ihrer Aufgaben und Verbesserung der Benutzererfahrung.",
        emoji: "‚öôÔ∏è"
      },
      {
        title: "Online-Shops",
        description: "Moderne und schnelle E-Commerce-L√∂sungen ohne monatliche Geb√ºhren traditioneller Plattformen.",
        emoji: "üõí"
      },
      {
        title: "Beratung",
        description: "Beratung, um Ihre bestehenden Websites schneller, weniger energieintensiv und benutzerfreundlicher zu machen.",
        emoji: "üí°"
      }
    ],
    projectsTitle: "Aktuelle Projekte",
    projectButton: "Projekt entdecken",
    viewAllProjectsButton: "Alle Projekte ansehen",
    // Motivations
    motivationTitle: "Was mich antreibt",
    motivationIntro: "Ich glaube an ein Web, das Geschwindigkeit, Einfachheit und Umweltbewusstsein vereint. Heute sind zu viele Websites schwer, laden langsam und verbrauchen viel Energie, obwohl man es leicht anders machen kann! Mein Ansatz basiert auf diesen Prinzipien:",
    motivationPrinciples: [
      {
        title: "Die richtige Technologie am richtigen Ort",
        description: "Moderne Browser k√∂nnen viele Dinge tun, ohne tonnenweise zus√§tzliche Module installieren zu m√ºssen. Ich nutze bestehende Technologien und ihre Weiterentwicklungen intelligent, um fl√ºssige Erlebnisse zu schaffen."
      },
      {
        title: "Respekt f√ºr Besucher",
        description: "Keine nervigen Pop-ups oder Banner, die die Navigation st√∂ren. Ein angenehmes Erlebnis, bei dem Benutzer die Kontrolle √ºber ihre Navigation und Daten behalten."
      },
      {
        title: "Leicht zuerst, leistungsstark bei Bedarf",
        description: "Pr√§sentations-Website? Ultraschnelle vorgenerierte Seiten. Einfacher E-Commerce? Dasselbe, mit nur wenigen On-Demand-Funktionen. Interaktive App mit Chat? Dort verwende ich Elixir/Phoenix, entwickelt, um Tausende simultane Benutzer effizient zu verarbeiten."
      }
    ],
    didYouKnowTitle: "Wussten Sie schon?",
    didYouKnowItems: [
      {
        text: "Entgegen der landl√§ufigen Meinung verlangt das Gesetz nicht, auf allen Websites ein Cookie-Banner anzuzeigen. Diese Banner sind nur obligatorisch, wenn Ihre Website Tracker verwendet, die nicht unbedingt f√ºr den Betrieb erforderlich sind.",
        source: "GDPR.eu - Cookies, the GDPR, and the ePrivacy Directive",
        link: "https://gdpr.eu/cookies/"
      },
      {
        text: "53% der Besucher verlassen eine Website, die mehr als 3 Sekunden zum Laden ben√∂tigt. Eine schnelle Website ist unerl√§sslich, um Besucher nicht zu verlieren.",
        source: "Think with Google - Mobile page speed benchmarks",
        link: "https://support.google.com/adsense/answer/7450973/"
      },
      {
        text: "Es ist durchaus m√∂glich, die Besuche Ihrer Website zu analysieren, ohne Tracking-Cookies zu verwenden oder die Privatsph√§re Ihrer Besucher zu gef√§hrden.",
        details: "L√∂sungen wie Plausible, Umami Cloud oder Matomo (im Cookie-freien Modus) geben Ihnen genaue Statistiken unter Wahrung der Privatsph√§re, ohne ausdr√ºckliche Zustimmung zu ben√∂tigen."
      }
    ],
    quoteText: "Wie oft haben Sie eine Website verlassen, weil sie zu langsam war oder Sie bel√§stigte, Cookies zu akzeptieren? Ich bevorzuge ein leichteres Web, das die Aufmerksamkeit der Besucher respektiert und auf allen Ger√§ten ohne Frustration gut funktioniert."
  },
};

// Utiliser la langue demand√©e ou fran√ßais par d√©faut
const t = content[lang] || content.fr;

---

<Layout title={t.title} description={t.description} lang={lang}>
  <div class="container md:mt-3 mt-0 mx-auto px-4 md:py-8 py-0">
    <!-- Section hero repens√©e avec l'animation de typewriter -->
    <section class="py-8 md:py-12">
      <div class="flex flex-col md:flex-row gap-8">
        <div class="md:w-2/3">
          <h1 class="text-3xl md:text-4xl font-bold mb-4">
            <div class="flex flex-wrap items-baseline gap-2">
              <div class="typewriter-part1">
                <span class="typewriter-text-base">
                  {lang === "fr" 
                    ? "Cr√©ateur de"
                    : lang === "en" 
                      ? "Full Stack" 
                      : "Full Stack"
                  }
                </span>
              </div>
              <div class="typewriter-part2">
                <span class="typewriter-text-highlight text-light">
                  {lang === "fr" 
                    ? " sites internet"
                    : lang === "en" 
                      ? "Web Developer" 
                      : "Webentwickler"
                  }
                </span>
              </div>
            </div>
          </h1>
          <p class="text-lg mb-6">
            {t.heroText}
          </p>
          <div class="flex flex-wrap gap-4">
            <a href={`/${lang}/contact/`} class="cta-button">
              {t.contactButton}
            </a>
            <a href={`/${lang}/projects/`} class="btn-secondary">
              {t.projectsButton}
            </a>
          </div>
        </div>
        <div class="md:w-1/3">
          <div class="bg-secondary rounded-lg p-4 max-w-4/5 md:max-w-full mx-auto md:mx-0">
            <Picture
              src={monImage}
              widths={[400, 600]}
              formats={["avif", "webp", "jpg"]}
              alt={`Josselin HANEL - ${lang === "fr" ? "Cr√©ateur de sites internet" : lang === "en" ? "Full Stack Developer" : "Full-Stack-Entwickler"}`}
              class="w-full h-auto object-cover rounded"
              data-astro-transition-persist="profile-image"
              loading="eager"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- Section valeurs principales -->
    <section class="py-4 bg-secondary bg-opacity-30 rounded-lg mb-12">
      <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {t.values.map((value, index) => (
            <div class={`p-4 border border-accent border-opacity-30 corner-style-bold scale-up`} data-index={index}>
              <div class="flex justify-between items-center mb-2">
                <h2 class="text-xl font-semibold text-accent">{value.title}</h2>
                <span class="text-2xl">{value.emoji}</span>
              </div>
              <p class="text-pretty">{value.description}</p>
            </div>
          ))}
        </div>
      </div>
    </section>
    

    <!-- Section ce qui m'anime -->
<section class="py-2 sm:py-8 mb-12 fade-in opacity-0 translate-y-6 transition-all duration-500">
  <h2 class="text-2xl font-bold mb-6 border-b border-accent pb-2">
    {t.motivationTitle}
  </h2>
  
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    <!-- Colonne avec texte principal -->
    <div class="bg-secondary bg-opacity-10 p-6 rounded-lg border-l-4 border-accent">
      <p class="text-lg mb-4">{t.motivationIntro}</p>
      
      <ul class="text-lg space-y-6">
        {t.motivationPrinciples.map((principle, index) => (
          <li class="flex items-start">
            <span class="text-accent font-bold mr-2">{index + 1}.</span>
            <p><strong>{principle.title}</strong> : {principle.description}</p>
          </li>
        ))}
      </ul>
    </div>
    
    <!-- Colonne avec le "savais-tu" et la citation -->
    <div class="flex flex-col gap-4">
      <div class="bg-secondary bg-opacity-30 p-5 rounded-lg">
        <h3 class="text-xl font-semibold mb-3 text-accent">
          {t.didYouKnowTitle}
        </h3>
        <div class="space-y-3">
          {t.didYouKnowItems.map((item) => (
            <div class="mb-3 p-3 bg-primary bg-opacity-30 corner-style">
              <p class="mb-2">{item.text}</p>
              {item.details && <p class="text-sm text-text-muted">{item.details}</p>}
              {item.source && (
                <p class="text-sm text-text-muted mt-2">
                  <a href={item.link} target="_blank" rel="noopener noreferrer" class="text-link">{item.source}</a>
                </p>
              )}
            </div>
          ))}
        </div>
      </div>
      
      <div class="bg-secondary bg-opacity-40 p-5 rounded-lg border-l-2 border-accent">
        <blockquote class="italic">{t.quoteText}</blockquote>
      </div>
    </div>
  </div>
</section>

    <!-- Section services -->
    <section class="py-2 sm:py-8 mb-12 fade-in opacity-0 translate-y-6 transition-all duration-500">
      <h2 class="text-2xl font-bold mb-6 border-b border-accent pb-2">
        {t.servicesTitle}
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {t.services.map((service) => (
          <div class="bg-secondary bg-opacity-30 p-5 corner-style-bold">
            <div class="flex justify-between items-center mb-3">
              <h3 class="text-xl font-semibold text-accent">{service.title}</h3>
              <span class="text-2xl">{service.emoji}</span>
            </div>
            <p>
              {service.description}
            </p>
          </div>
        ))}
      </div>
    </section>
    
    <!-- Section projets en vedette -->
<section class="py-2 sm:py-8 fade-in opacity-0 translate-y-6 transition-all duration-500">
  <h2 class="text-2xl font-bold mb-6 border-b border-accent pb-2">
    {t.projectsTitle}
  </h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    {recentProjects.map(async (project) => {
      const heroImage = await loadHeroImage(project.data.slug);
      return (
        <div class="project-card w-full">
          <div class="flex flex-col flex-1">
            <!-- Couverture du projet -->
            <a href={`/${lang}/${project.data.slug}/`} class="block bg-primary bg-opacity-30 aspect-video w-full relative">
              <Picture
                src={heroImage}
                widths={[400, 740, 1080]}
                sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 33vw"
                formats={["avif", "webp", "jpg"]}
                alt={project.data.title[lang]}
                class="w-full h-full object-cover"
                loading="lazy"
              />
            </a>
          
            <!-- Contenu du projet -->
            <div class="p-4 flex flex-col h-full">
              <div class="flex-1">
                <h3 class="text-xl font-bold mb-2">{project.data.title[lang]}</h3>
                <p class="mb-4" set:html={project.data.description[lang]}></p>
                
                <!-- Technologies -->
                <div class="mb-4">
                  <div class="flex flex-wrap gap-1.5">
                    {project.data.tech.map((tech) => (
                      <span class="px-2 py-0.5 border border-accent text-light rounded-full text-xs">
                        {tech}
                      </span>
                    ))}
                  </div>
                </div>
              </div>
              
              <!-- Boutons -->
              <div class="mt-auto">
                <div class="flex gap-3">
                  <a href={`/${lang}/${project.data.slug}/`} class="btn-secondary flex-1 text-center">
                    {t.projectButton}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    })}
  </div>
  <div class="text-center mt-8">
    <a href={`/${lang}/projects/`} class="btn-secondary">
      {t.viewAllProjectsButton}
    </a>
  </div>
</section>

    <!-- Section appel √† l'action -->
    <section>
      <CtaDispo transition-persist="cta-dispo"/>
    </section>
  </div>
  <script>
    document.addEventListener("astro:page-load", () => {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            // V√©rifiez si l'√©l√©ment a la classe 'fade-in'
            if (entry.target.classList.contains('fade-in')) {
              entry.target.classList.remove('opacity-0', 'translate-y-6');
            }

            // V√©rifiez si l'√©l√©ment contient des blocs 'scale-up'
            const scaleUpBlocks = entry.target.querySelectorAll('.scale-up');
            if (scaleUpBlocks.length > 0) {
              scaleUpBlocks.forEach((block, index) => {
                setTimeout(() => {
                  block.classList.add('visible');
                }, index * 200); // Ajustez le d√©lai ici (200ms entre chaque bloc)
              });
            }

            // Arr√™tez d'observer apr√®s la premi√®re intersection
            observer.unobserve(entry.target);
          }
        });
      }, 
      {
        rootMargin: '0px 0px -5% 0px', // Ajustez cette valeur pour contr√¥ler quand l'animation commence
        threshold: 0.1,
      });

      // Observez toutes les sections avec les classes 'fade-in' ou contenant des blocs 'scale-up'
      document.querySelectorAll('.fade-in, .py-4.bg-secondary.bg-opacity-30.rounded-lg.mb-12').forEach((section) => {
        observer.observe(section);
      });
    });
  </script>
</Layout>