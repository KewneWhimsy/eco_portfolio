---
// Import du layout avec mode éco activé
import Layout from "../../../layouts/layout.astro";
import { Picture } from "astro:assets";
import esportImage from "../../../assets/projects/esport00.png";

// Récupérer le paramètre de langue depuis l'URL
export function getStaticPaths() {
  return [
    { params: { lang: "fr" } },
    { params: { lang: "en" } },
    { params: { lang: "de" } },
  ];
}

const lang = Astro.params.lang as "fr" | "en" | "de";

// Contenu traduit pour chaque langue
const content = {
  fr: {
    title: "Application e-sport avec chat | Josselin HANEL (Mode Éco)",
    description: "Version éco-responsable de la page projet E-sport - Plateforme de gestion d'événements e-sport avec système de chat en temps réel.",
    projectTitle: "Application e-sport avec chat",
    projectIntro: "Cette plateforme permet aux organisateurs d'événements e-sport de créer et gérer des tournois, tout en offrant aux participants un moyen de communiquer en temps réel via un système de chat intégré.",
    
    overviewTitle: "Aperçu du projet",
    overviewText: "Ce projet démontre l'intégration d'un chat en temps réel dans une application web avec une architecture claire séparant les responsabilités. Le frontend utilise Astro pour le rendu statique avec des îlots interactifs via Alpine.js et HTMX, tandis que le backend utilise Express avec son module WebSocket pour gérer à la fois les requêtes API et la communication en temps réel.",

    architectureTitle: "Architecture du projet",
    frontendDetails: [
      "Astro pour le rendu statique avec hydratation partielle",
      "Alpine.js pour la gestion de l'état local et les interactions UI légères",
      "HTMX pour les requêtes AJAX et l'interaction avec le serveur sans JavaScript complexe",
      "Tailwind CSS pour un styling efficace avec des classes utilitaires"
    ],
    backendDetails: [
      "Architecture monolithique intégrée pour simplicité et maintenance",
      "Serveur Express gérant à la fois l'API REST et la communication WebSocket",
      "Module WebSocket natif d'Express pour la communication en temps réel",
      "MongoDB pour le stockage des messages et des données utilisateurs",
      "PostgreSQL pour les données structurées (événements, tournois, équipes)"
    ],

    challengesTitle: "Défis techniques",
    challenges: [
      "Concevoir une architecture où Express gère de manière cohérente à la fois les requêtes HTTP traditionnelles et les connexions WebSocket persistantes",
      "Maintenir la cohérence des données entre le frontend et le backend (API REST et WebSocket)",
      "Choisir les technologies appropriées pour chaque partie de l'application: HTMX standard pour les opérations CRUD et l'extension WebSocket de HTMX uniquement pour les fonctionnalités nécessitant une communication en temps réel",
      "Mettre en place un système d'authentification cohérent pour l'API REST et les connexions WebSocket"
    ],
    
    solutionsTitle: "Solutions mises en œuvre",
    solutions: [
      {
        title: "Serveur Express intégré",
        description: "Utilisation d'un serveur Express unique intégrant nativement WebSocket, simplifiant le déploiement et la maintenance tout en assurant une communication fluide entre les différentes parties de l'application."
      },
      {
        title: "Gestion des événements",
        description: "Système permettant aux utilisateurs de créer des événements, de s'y abonner, et aux modérateurs de les gérer via un dashboard dédié, assurant une expérience communautaire fluide."
      },
      {
        title: "HTMX pour la simplicité",
        description: "HTMX permet d'obtenir une expérience dynamique semblable à une SPA mais avec beaucoup moins de JavaScript côté client, rendant l'application plus légère et réactive."
      },
      {
        title: "WebSocket pour le chat en temps réel",
        description: "Utilisation ciblée de WebSocket via l'extension HTMX uniquement pour les fonctionnalités de chat, offrant une expérience en temps réel là où elle est vraiment nécessaire tout en gardant l'application légère."
      }
    ],
    
    lessonsTitle: "Leçons apprises",
    lessons: [
      "L'architecture monolithique avec Express peut offrir une excellente séparation des préoccupations en interne tout en simplifiant le déploiement et la maintenance",
      "HTMX et WebSocket forment une combinaison puissante pour créer des interfaces dynamiques avec peu de JavaScript",
      "L'utilisation de bases de données spécialisées pour différents types de données (PostgreSQL pour les données structurées, MongoDB pour les messages) permet d'optimiser les performances",
      "Une bonne documentation des API et des modules internes est essentielle même dans une architecture monolithique"
    ],
    
    techTitle: "Technologies utilisées",
    techUsed: "Astro, Tailwind CSS, Alpine.js, HTMX, WebSocket, Express, PostgreSQL, MongoDB",
    
    visitSite: "Visiter le prototype",
    viewSourceCode: "Voir le code source",
    allProjects: "Tous les projets",
    nextProject: "Projet suivant",
    prevProject: "Projet précédent",

    reflectionTitle: "Réflexion personnelle",
    reflectionText: "Ce projet a été une excellente occasion d'explorer une architecture monolithique bien structurée avec des responsabilités clairement définies. L'utilisation d'Express avec son module WebSocket natif pour gérer à la fois l'API REST et la communication en temps réel s'est avérée être une solution élégante et performante. J'ai particulièrement apprécié l'intégration de HTMX qui permet d'obtenir une expérience utilisateur dynamique avec un minimum de JavaScript. Ce projet a été développé avec Express pour sa simplicité d'implémentation et sa flexibilité. Si l'application venait à gagner en popularité, j'envisagerais de migrer vers un backend Phoenix/Elixir pour ses capacités de concurrence et de mise à l'échelle supérieures.",

    ecoModeTitle: "Mode Éco activé",
    ecoModeText: "Vous consultez actuellement la version ultra-légère de mon portfolio."
  },
  en: {
    title: "E-sport Application with Chat | Josselin HANEL (Eco Mode)",
    description: "Eco-friendly version of the E-sport project page - E-sport event management platform with a real-time chat system.",
    projectTitle: "E-sport Application with Chat",
    projectIntro: "This platform allows e-sport event organizers to create and manage tournaments, while offering participants a way to communicate in real-time via an integrated chat system.",
    
    overviewTitle: "Project overview",
    overviewText: "This project demonstrates the integration of real-time chat into a web application with a clear architecture separating responsibilities. The frontend uses Astro for static rendering with interactive islands via Alpine.js and HTMX, while the backend uses Express with its WebSocket module to handle both API requests and real-time communication.",

    architectureTitle: "Project architecture",
    frontendDetails: [
      "Astro for static rendering with partial hydration",
      "Alpine.js for local state management and lightweight UI interactions",
      "HTMX for AJAX requests and server interaction without complex JavaScript",
      "Tailwind CSS for efficient styling with utility classes"
    ],
    backendDetails: [
      "Integrated monolithic architecture for simplicity and maintenance",
      "Express server handling both REST API and WebSocket communication",
      "Native WebSocket module for Express for real-time communication",
      "MongoDB for storing messages and user data",
      "PostgreSQL for structured data (events, tournaments, teams)"
    ],

    challengesTitle: "Technical challenges",
    challenges: [
      "Designing an architecture where Express consistently handles both traditional HTTP requests and persistent WebSocket connections",
      "Maintaining data consistency between the frontend and backend (REST API and WebSocket)",
      "Selecting the appropriate technologies for each part of the application: standard HTMX for CRUD operations and HTMX WebSocket extension only for features requiring real-time communication",
      "Implementing a consistent authentication system for the REST API and WebSocket connections"
    ],
    
    solutionsTitle: "Implemented solutions",
    solutions: [
      {
        title: "Integrated Express Server",
        description: "Using a single Express server with native WebSocket integration, simplifying deployment and maintenance while ensuring smooth communication between different parts of the application."
      },
      {
        title: "Event Management",
        description: "System allowing users to create events, subscribe to them, and moderators to manage them via a dedicated dashboard, ensuring a smooth community experience."
      },
      {
        title: "HTMX for simplicity",
        description: "HTMX provides a dynamic SPA-like experience but with much less client-side JavaScript, making the application lighter and more responsive."
      },
      {
        title: "WebSocket for real-time chat",
        description: "Targeted use of WebSocket through the HTMX extension only for chat features, providing a real-time experience where it's truly needed while keeping the application lightweight."
      }
    ],
    
    lessonsTitle: "Lessons learned",
    lessons: [
      "Monolithic architecture with Express can offer excellent separation of concerns internally while simplifying deployment and maintenance",
      "HTMX and WebSocket form a powerful combination for creating dynamic interfaces with little JavaScript",
      "Using specialized databases for different types of data (PostgreSQL for structured data, MongoDB for messages) optimizes performance",
      "Good documentation of APIs and internal modules is essential even in a monolithic architecture"
    ],
    
    techTitle: "Technologies used",
    techUsed: "Astro, Tailwind CSS, Alpine.js, HTMX, WebSocket, Express, PostgreSQL, MongoDB",
    
    visitSite: "Visit prototype",
    viewSourceCode: "View source code",
    allProjects: "All projects",
    nextProject: "Next project",
    prevProject: "Previous project",

    reflectionTitle: "Personal reflection",
    reflectionText: "This project was an excellent opportunity to explore a well-structured monolithic architecture with clearly defined responsibilities. Using Express with its native WebSocket module to handle both REST API and real-time communication proved to be an elegant and performant solution. I particularly appreciated the integration of HTMX, which provides a dynamic user experience with minimal JavaScript. This project was developed with Express for its ease of implementation and flexibility. If the application were to gain popularity, I would consider migrating to a Phoenix/Elixir backend for its superior concurrency and scaling capabilities.",

    ecoModeTitle: "Eco Mode activated",
    ecoModeText: "You are currently viewing the ultra-lightweight version of my portfolio."
  },
  de: {
    title: "E-Sport-Anwendung mit Chat | Josselin HANEL (Öko-Modus)",
    description: "Umweltfreundliche Version der E-Sport-Projektseite - E-Sport-Eventmanagement-Plattform mit einem Echtzeit-Chat-System.",
    projectTitle: "E-Sport-Anwendung mit Chat",
    projectIntro: "Diese Plattform ermöglicht es E-Sport-Veranstaltern, Turniere zu erstellen und zu verwalten, während sie den Teilnehmern eine Möglichkeit bietet, über ein integriertes Chat-System in Echtzeit zu kommunizieren.",
    
    overviewTitle: "Projektübersicht",
    overviewText: "Dieses Projekt demonstriert die Integration eines Echtzeit-Chats in eine Webanwendung mit einer klaren Architektur, die Verantwortlichkeiten trennt. Das Frontend verwendet Astro für statisches Rendering mit interaktiven Inseln über Alpine.js und HTMX, während das Backend Express mit seinem WebSocket-Modul verwendet, um sowohl API-Anfragen als auch Echtzeit-Kommunikation zu verarbeiten.",

    architectureTitle: "Projektarchitektur",
    frontendDetails: [
      "Astro für statisches Rendering mit partieller Hydratation",
      "Alpine.js für lokale Zustandsverwaltung und leichtgewichtige UI-Interaktionen",
      "HTMX für AJAX-Anfragen und Serverinteraktion ohne komplexes JavaScript",
      "Tailwind CSS für effizientes Styling mit Utility-Klassen"
    ],
    backendDetails: [
      "Integrierte monolithische Architektur für Einfachheit und Wartung",
      "Express-Server, der sowohl REST-API als auch WebSocket-Kommunikation verarbeitet",
      "Natives WebSocket-Modul für Express für Echtzeit-Kommunikation",
      "MongoDB für die Speicherung von Nachrichten und Benutzerdaten",
      "PostgreSQL für strukturierte Daten (Veranstaltungen, Turniere, Teams)"
    ],

    challengesTitle: "Technische Herausforderungen",
    challenges: [
      "Entwicklung einer Architektur, in der Express sowohl traditionelle HTTP-Anfragen als auch persistente WebSocket-Verbindungen konsistent verarbeitet",
      "Aufrechterhaltung der Datenkonsistenz zwischen dem Frontend und Backend (REST-API und WebSocket)",
      "Auswahl der geeigneten Technologien für jeden Teil der Anwendung: Standard-HTMX für CRUD-Operationen und HTMX-WebSocket-Erweiterung nur für Funktionen, die Echtzeit-Kommunikation erfordern",
      "Implementierung eines konsistenten Authentifizierungssystems für die REST-API und WebSocket-Verbindungen"
    ],
    
    solutionsTitle: "Umgesetzte Lösungen",
    solutions: [
      {
        title: "Integrierter Express-Server",
        description: "Verwendung eines einzelnen Express-Servers mit nativer WebSocket-Integration, wodurch Bereitstellung und Wartung vereinfacht werden und gleichzeitig eine reibungslose Kommunikation zwischen verschiedenen Teilen der Anwendung gewährleistet wird."
      },
      {
        title: "Ereignisverwaltung",
        description: "System, das Benutzern ermöglicht, Ereignisse zu erstellen, sie zu abonnieren und Moderatoren, diese über ein dediziertes Dashboard zu verwalten, um ein reibungsloses Gemeinschaftserlebnis zu gewährleisten."
      },
      {
        title: "HTMX für Einfachheit",
        description: "HTMX bietet ein dynamisches SPA-ähnliches Erlebnis, aber mit viel weniger clientseitigem JavaScript, wodurch die Anwendung leichter und reaktionsschneller wird."
      },
      {
        title: "WebSocket für Echtzeit-Chat",
        description: "Gezielter Einsatz von WebSocket über die HTMX-Erweiterung nur für Chat-Funktionen, was eine Echtzeit-Erfahrung bietet, wo sie wirklich benötigt wird, und gleichzeitig die Anwendung leicht hält."
      }
    ],
    
    lessonsTitle: "Gelernte Lektionen",
    lessons: [
      "Monolithische Architektur mit Express kann intern eine hervorragende Trennung der Zuständigkeiten bieten und gleichzeitig Bereitstellung und Wartung vereinfachen",
      "HTMX und WebSocket bilden eine leistungsstarke Kombination zur Erstellung dynamischer Schnittstellen mit wenig JavaScript",
      "Die Verwendung spezialisierter Datenbanken für verschiedene Arten von Daten (PostgreSQL für strukturierte Daten, MongoDB für Nachrichten) optimiert die Leistung",
      "Eine gute Dokumentation von APIs und internen Modulen ist auch in einer monolithischen Architektur unerlässlich"
    ],
    
    techTitle: "Verwendete Technologien",
    techUsed: "Astro, Tailwind CSS, Alpine.js, HTMX, WebSocket, Express, PostgreSQL, MongoDB",
    
    visitSite: "Prototyp besuchen",
    viewSourceCode: "Quellcode ansehen",
    allProjects: "Alle Projekte",
    nextProject: "Nächstes Projekt",
    prevProject: "Vorheriges Projekt",

    reflectionTitle: "Persönliche Reflexion",
    reflectionText: "Dieses Projekt war eine ausgezeichnete Gelegenheit, eine gut strukturierte monolithische Architektur mit klar definierten Verantwortlichkeiten zu erkunden. Die Verwendung von Express mit seinem nativen WebSocket-Modul zur Verarbeitung sowohl der REST-API als auch der Echtzeit-Kommunikation erwies sich als elegante und leistungsstarke Lösung. Besonders geschätzt habe ich die Integration von HTMX, das ein dynamisches Benutzererlebnis mit minimalem JavaScript bietet. Dieses Projekt wurde mit Express für seine einfache Implementierung und Flexibilität entwickelt. Sollte die Anwendung an Popularität gewinnen, würde ich eine Migration zu einem Phoenix/Elixir-Backend für seine überlegenen Nebenläufigkeits- und Skalierungsfähigkeiten in Betracht ziehen.",

    ecoModeTitle: "Öko-Modus aktiviert",
    ecoModeText: "Sie sehen gerade die ultraleichte Version meines Portfolios."
  }
};

// Obtenir les projets précédent et suivant selon la langue
const getProjectUrl = (projectId: string) => `/${lang}/${projectId}/eco/`;
const prevProject = {
  id: "objet",
  title: lang === "fr" ? 
    "Bibliothèque d'objets - Quimper" :
    (lang === "en" ? 
      "Object Library - Quimper" : 
      "Objektbibliothek - Quimper")
};
const nextProject = {
  id: "portfolio",
  title: lang === "fr" ? 
    "Portfolio personnel éco-responsable" :
    (lang === "en" ? 
      "Eco-friendly personal portfolio" : 
      "Umweltfreundliches persönliches Portfolio")
};

// Utiliser la langue demandée ou français par défaut
const t = content[lang] || content.fr;

// Mode éco activé
const isEcoMode = true;
---

<Layout title={t.title} description={t.description} lang={lang} isEcoMode={isEcoMode}>
  <div class="container mx-auto px-4 py-6">
    <!-- Section d'introduction du mode éco -->
    <section class="py-4 border-b border-secondary mb-6">
      <h2 class="text-xl font-bold mb-2">{t.ecoModeTitle}</h2>
      <p class="mb-3 max-w-4xl">
        {t.ecoModeText}
      </p>
    </section>

    <div class="mb-4">
      <a href={`/${lang}/projects/eco/`} class="text-text-muted hover:text-accent transition-colors">
        &larr; {t.allProjects}
      </a>
    </div>
    
    <!-- En-tête du projet -->
    <header class="mb-8">
      <h1 class="text-2xl font-bold mb-4 border-b border-accent pb-2">
        {t.projectTitle} (2025)
      </h1>
      <p class="mb-4 max-w-4xl">
        {t.projectIntro}
      </p>
    </header>
    
    <!-- Aperçu du projet -->
    <section class="mb-8 pb-6">
      <h2 class="text-xl font-semibold mb-3 text-accent">
        {t.overviewTitle}
      </h2>
      <p class="mb-4 max-w-4xl">
        {t.overviewText}
      </p>
      
      <!-- Actions principales -->
      <div class="flex flex-wrap gap-4 mb-8">
        <a
          href="https://kewnewhimsy.github.io/esportify-f/"
          target="_blank"
          rel="noopener noreferrer"
          class="cta-button"
        >
          {t.visitSite}
        </a>
        <a
          href="https://github.com/KewneWhimsy/esportify-f"
          target="_blank"
          rel="noopener noreferrer"
          class="btn-secondary"
        >
          {
            lang === "fr"
              ? "Repo Frontend"
              : "Frontend Repo"
          }
        </a>
        <a
          href="https://github.com/KewneWhimsy/esportify-b"
          target="_blank"
          rel="noopener noreferrer"
          class="btn-secondary"
        >
          {
            lang === "fr"
              ? "Repo Backend"
              : "Backend Repo"
          }
        </a>
      </div>
      <!-- Image principale légère en mode éco -->
      <div class="mb-8 border-b border-secondary pb-6">
        <Picture
          src={esportImage}
          widths={[1200]}
          formats={["avif, webp, png"]}
          alt={t.projectTitle}
          class="w-full rounded my-3 max-w-5xl mx-auto"
          loading="lazy"
        />
      </div>
    </section>
    
    <!-- Architecture du projet -->
    <section class="mb-8 border-b border-secondary pb-6">
      <h2 class="text-xl font-semibold mb-3 text-accent">
        {t.architectureTitle}
      </h2>
      
      <div class="mb-4">
        <h3 class="font-medium mb-2">Frontend:</h3>
        <ul class="list-disc pl-5 mb-3">
          {t.frontendDetails.map(detail => (
            <li class="mb-1">{detail}</li>
          ))}
        </ul>
      </div>
      
      <div class="mb-4">
        <h3 class="font-medium mb-2">Backend:</h3>
        <ul class="list-disc pl-5 mb-3">
          {t.backendDetails.map(detail => (
            <li class="mb-1">{detail}</li>
          ))}
        </ul>
      </div>
    </section>
    
    <!-- Défis techniques -->
    <section class="mb-8 border-b border-secondary pb-6">
      <h2 class="text-xl font-semibold mb-3 text-accent">
        {t.challengesTitle}
      </h2>
      <ul class="list-disc pl-5 mb-3">
        {t.challenges.map(challenge => (
          <li class="mb-2">{challenge}</li>
        ))}
      </ul>
    </section>
    
    <!-- Solutions mises en œuvre -->
    <section class="mb-8 border-b border-secondary pb-6">
      <h2 class="text-xl font-semibold mb-3 text-accent">
        {t.solutionsTitle}
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-3">
        {t.solutions.map(solution => (
          <div class="bg-secondary bg-opacity-10 p-3 rounded">
            <h3 class="font-medium mb-1">{solution.title}</h3>
            <p class="text-text-muted">{solution.description}</p>
          </div>
        ))}
      </div>
    </section>
    
    <!-- Leçons apprises -->
    <section class="mb-8 border-b border-secondary pb-6">
      <h2 class="text-xl font-semibold mb-3 text-accent">
        {t.lessonsTitle}
      </h2>
      <ul class="pl-5 space-y-2 mb-3">
        {t.lessons.map(lesson => (
          <li>
            <span class="text-accent mr-2">•</span>
            {lesson}
          </li>
        ))}
      </ul>
    </section>
    
    <!-- Réflexion personnelle -->
    <section class="mb-8 border-b border-secondary pb-6">
      <h2 class="text-xl font-semibold mb-3 text-accent">
        {t.reflectionTitle}
      </h2>
      <p class="italic mb-3 max-w-4xl">
        {t.reflectionText}
      </p>
    </section>
    
    <!-- Technologies utilisées -->
    <section class="mb-8">
      <h2 class="text-xl font-semibold mb-3 text-accent">
        {t.techTitle}
      </h2>
      <p class="mb-3 max-w-4xl">
        {t.techUsed}
      </p>
    </section>
    
    <!-- Navigation entre projets -->
    <div class="pt-8 mt-12 flex justify-between">
      <a href={`/${lang}/objet/eco/`} class="text-link">
        &larr; {t.prevProject}: {prevProject.title}
      </a>
      <a href={getProjectUrl(nextProject.id)} class="text-link">
        {t.nextProject}: {nextProject.title} &rarr;
      </a>
    </div>
  </div>
</Layout>